<!doctype html><html lang=de><head><meta charset=utf-8><meta name=description content="Was ist AUSST? Durch das starke Standing von Adobe Produkten in vielen Unternehmen und schwacher Konkurenz sind Anwendungen wie Photoshop oder Illustrator aus den Umgebungen nicht mehr wegzudenken."><meta property="og:title" content="Adobe AUSST"><meta property="og:description" content="Was ist AUSST? Durch das starke Standing von Adobe Produkten in vielen Unternehmen und schwacher Konkurenz sind Anwendungen wie Photoshop oder Illustrator aus den Umgebungen nicht mehr wegzudenken."><meta property="og:type" content="website"><meta property="og:image" content="https://wiki.timogremler.de/icon.png"><meta property="og:url" content="https://wiki.timogremler.de/notes/Anleitungen/Adobe-Update-Setup-Server-Tool-AUSST/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content="Adobe AUSST"><meta name=twitter:description content="Was ist AUSST? Durch das starke Standing von Adobe Produkten in vielen Unternehmen und schwacher Konkurenz sind Anwendungen wie Photoshop oder Illustrator aus den Umgebungen nicht mehr wegzudenken."><meta name=twitter:image content="https://wiki.timogremler.de/icon.png"><title>Adobe AUSST</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon type=image/x-icon href=https://wiki.timogremler.de//favicon.ico><link href=https://wiki.timogremler.de/styles.f229fbaa79b2d3324287c85c3cfe28aa.min.css rel=stylesheet><link href=https://wiki.timogremler.de/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://wiki.timogremler.de/js/darkmode.f9fb6336f39e839c928dc369a3e7fb57.min.js></script>
<script src=https://wiki.timogremler.de/js/util.a0ccf91e1937fe761a74da4946452710.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script async src=https://wiki.timogremler.de/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://wiki.timogremler.de/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://wiki.timogremler.de/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://wiki.timogremler.de/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://wiki.timogremler.de/",fetchData=Promise.all([fetch("https://wiki.timogremler.de/indices/linkIndex.a38eb055b60fe98d3a49d9414332da22.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://wiki.timogremler.de/indices/contentIndex.b65fe41a4e027cff4135b29d0dddd4e5.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://wiki.timogremler.de",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://wiki.timogremler.de",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/wiki.timogremler.de\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=wiki.timogremler.de src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Suche placeholder="Suche nach etwas ..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://wiki.timogremler.de/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><main class=main-container><div class=blur-element></div><aside class="main-aside disabled"><nav><div class=close-nav-mobile></div><h1 class=navbar-heading>Dateiverzeichnis</h1><ul><li class=folder><div class=wrapper><div class=a-wrapper><div class=arrow></div></div><a href=/notes/ class=title>Notizen</a></div><ul><li class=folder><div class=wrapper><div class=a-wrapper><div class=arrow></div></div><a href=/notes/Anleitungen/ class=title>Anleitungen</a></div><ul><li class=navbar-item><a href=/notes/Anleitungen/Active-Directory-Testumgebung-f%C3%BCr-Auszubildende-zum-lernen/ class=page-link>Active Directory Testumgebung für Auszubildende zum lernen</a></li><li class=navbar-item><a href=/notes/Anleitungen/Adobe-Update-Setup-Server-Tool-AUSST/ class=page-link>Adobe AUSST</a></li><li class=navbar-item><a href=/notes/Anleitungen/PIM-Local-Administrator/ class=page-link>Azure AD Joined Device Local Administrator - "Dieser Vorgang erfordert erhöhte Rechte"</a></li><li class=navbar-item><a href=/notes/Anleitungen/Installation-einer-VM-unter-Windows-auf-Basis-von-Hyper-V/ class=page-link>Installation einer VM unter Windows auf Basis von Hyper-V</a></li><li class=navbar-item><a href=/notes/Anleitungen/Anleitungen/ class=page-link>MOC Anleitungen</a></li></ul></li><li class=folder><div class=wrapper><div class=a-wrapper><div class=arrow></div></div><a href=/notes/Blog/ class=title>Blog</a></div><ul><li class=navbar-item><a href=/notes/Blog/Bionic-Reading/ class=page-link>Bionic Reading</a></li><li class=navbar-item><a href=/notes/Blog/Die-PARA-Methode/ class=page-link>Die PARA Methode</a></li><li class=navbar-item><a href=/notes/Blog/Blog/ class=page-link>MOC Blog</a></li><li class=navbar-item><a href=/notes/Blog/Zeitmanagement-Was-wir-von-Computern-lernen-k%C3%B6nnen/ class=page-link>Zeitmanagement - Was wir von Computern lernen können</a></li></ul></li><li class=folder><div class=wrapper><div class=a-wrapper><div class=arrow></div></div><a href=/notes/Technik/ class=title>Technik</a></div><ul><li class=folder><div class=wrapper><div class=a-wrapper><div class=arrow></div></div><a href=/notes/Technik/Backup/ class=title>Backup</a></div><ul><li class=navbar-item><a href=/notes/Technik/Backup/Gickup/ class=page-link>Gickup - Backup für GitHub, Gitea und co.</a></li></ul></li><li class=folder><div class=wrapper><div class=a-wrapper><div class=arrow></div></div><a href=/notes/Technik/Homelab/ class=title>Homelab</a></div><ul><li class=navbar-item><a href=/notes/Technik/Homelab/Homelab-Stand-03-2023/ class=page-link>Homelab Stand 03-2023</a></li></ul></li><li class=navbar-item><a href=/notes/Technik/JustDeleteMe.xyz/ class=page-link>JustDeleteMe.xyz</a></li><li class=navbar-item><a href=/notes/Technik/Technik/ class=page-link>MOC Technik</a></li><li class=navbar-item><a href=/notes/Technik/robots-txt/ class=page-link>robots.txt</a></li><li class=folder><div class=wrapper><div class=a-wrapper><div class=arrow></div></div><a href=/notes/Technik/Security/ class=title>Security</a></div><ul><li class=navbar-item><a href=/notes/Technik/Security/DNS-Verschluesselung/ class=page-link>DoT und DoH? - DNS Verschlüsselung</a></li><li class=navbar-item><a href=/notes/Technik/Security/Password-Pepper/ class=page-link>Password Pepper</a></li><li class=navbar-item><a href=/notes/Technik/Security/security.txt/ class=page-link>security.txt</a></li><li class=navbar-item><a href=/notes/Technik/Security/Session-Token-Attacks/ class=page-link>Session Token Attacks</a></li></ul></li><li class=navbar-item><a href=/notes/Technik/Simplelogin/ class=page-link>Simplelogin</a></li><li class=navbar-item><a href=/notes/Technik/Terms-of-Service-Didnt-Read/ class=page-link>TOSDR - Terms of Service Didnt Read</a></li><li class=folder><div class=wrapper><div class=a-wrapper><div class=arrow></div></div><a href=/notes/Technik/Windows/ class=title>Windows</a></div><ul><li class=navbar-item><a href=/notes/Technik/Windows/AppData/ class=page-link>AppData</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Microsoft-Link-Layer-Topology-Discovery/ class=page-link>Microsoft Link-Layer-Topology Discovery</a></li><li class=navbar-item><a href=/notes/Technik/Windows/ProgramData/ class=page-link>ProgramData</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Sysinternals/ class=page-link>Sysinternals</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Windows-10/ class=page-link>Windows 10</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Windows-Access-based-Enumaration/ class=page-link>Windows Access-based Enumaration</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Windows-Assigned-Access/ class=page-link>Windows Assigned Access</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Windows-File-History/ class=page-link>Windows File History</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Windows-Integrity-Level/ class=page-link>Windows Integrity Level</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Windows-LAPS/ class=page-link>Windows LAPS</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Windows-NTFS-Berechtigungen/ class=page-link>Windows NTFS Berechtigungen</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Windows-Registry/ class=page-link>Windows Registry</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Windows-Share-Berechtigungen/ class=page-link>Windows Share Berechtigungen</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Windows-Updates/ class=page-link>Windows Updates</a></li><li class=navbar-item><a href=/notes/Technik/Windows/Windows-User-Account-Control/ class=page-link>Windows User Account Control</a></li></ul></li></ul></li></ul></li><li class=folder><div class=wrapper><div class=a-wrapper><div class=arrow></div></div><a href=/%C3%9Cber-mich/ class=title>Über mich!</a></div><ul><li class=navbar-item><a href=/%C3%9Cber-mich/Persoenliches-Changelog/ class=page-link>Persönliches Changelog</a></li><li class=navbar-item><a href=/%C3%9Cber-mich/Timo-Gremler/ class=page-link>Über mich!</a></li></ul></li></ul></nav></aside><div class=singlePage><header class=main-header><div class=nav-wrapper><div class="nav-btn disabled"><div></div><div></div><div></div></div></div><h1 id=page-title><a class=root-title href=https://wiki.timogremler.de/>🪴 Timo Gremler</a></h1><div class=spacer></div><div class=search-wrapper><div id=search-icon><p>Suche</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Suchsymbol</title><desc id="desc">Symbol, um die Suche zu öffnen</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></div></header><article><h1>Adobe AUSST</h1><p class=meta>Zuletzt aktualisiert
Mar 22, 2023</p><ul class=tags><li><a href=https://wiki.timogremler.de/tags/Anleitung/>Anleitung</a></li><li><a href=https://wiki.timogremler.de/tags/Adobe/>Adobe</a></li><li><a href=https://wiki.timogremler.de/tags/AUSST/>AUSST</a></li></ul><aside class=mainTOC><details><summary>Inhaltsverzeichnis</summary><nav id=TableOfContents><ol><li><a href=#was-ist-ausst>Was ist AUSST?</a></li><li><a href=#wie-funktioniert-er>Wie funktioniert er?</a></li><li><a href=#vorteile>Vorteile</a></li><li><a href=#anleitung>Anleitung</a><ol><li><a href=#iis-server-vorbereitung>IIS Server Vorbereitung</a><ol><li><a href=#ausst-executable>AUSST Executable</a></li><li><a href=#skript>Skript</a></li></ol></li><li><a href=#ausst-synchronisation>AUSST Synchronisation</a><ol><li><a href=#inkrementelle-synchronisation>Inkrementelle Synchronisation</a></li><li><a href=#fresh-synchronisation>Fresh Synchronisation</a></li></ol></li><li><a href=#client-konfiguration>Client Konfiguration</a><ol><li><a href=#konfiguration-erstellen>Konfiguration erstellen</a></li><li><a href=#konfiguration-verteilen>Konfiguration verteilen</a></li></ol></li></ol></li></ol></nav></details></aside><a href=#was-ist-ausst><h2 id=was-ist-ausst><span class=hanchor arialabel=Anchor># </span>Was ist AUSST?</h2></a><p>Durch das starke Standing von Adobe Produkten in vielen Unternehmen und schwacher Konkurenz sind Anwendungen wie Photoshop oder Illustrator aus den Umgebungen nicht mehr wegzudenken.
Ließt man allerdings ein wenig durch die Release Notes oder schaut man in den einschlägigen IT News Webseiten tauchen die Adobe Produkte immer mal wieder mit Sicherheitslücken auf.
Das Adobe Update Setup Server Tool (AUSST) hilft Administratoren dabei das Update Management vieler Adobe Produkte zu zentralisieren, verwalten und zu steuern. Unter anderem werden dabei auch Netzwerkressourcen im Unternehmen entlastet - mit nur einem einzigen Server.</p><a href=#wie-funktioniert-er><h2 id=wie-funktioniert-er><span class=hanchor arialabel=Anchor># </span>Wie funktioniert er?</h2></a><p>Der AUSST Server lädt zentral die Update von Adobe aus dem Internet auf einem zentralen Server herunter. Dieser Server hält die Update Pakete für die konfigurierten Geräte vor. Dazu wird auf den Geräten die Adobe Create Cloud Desktop Applikation durch eine Config Datei angepasst welche den internen Update Server enthält. Benötigt wird lediglich ein Webserver - in diesem Artikel wird ein Microsoft IIS Webserver genutzt.</p><p><img src=/notes/images/AUSST-Basic.png width=auto></p><a href=#vorteile><h2 id=vorteile><span class=hanchor arialabel=Anchor># </span>Vorteile</h2></a><ul><li>Niedrigere Bandbreiten ins Internet</li><li>Steuerung welche Updates installiert werden</li><li>Single Application Paketierung (Nur Adobe Create Cloud Desktop notwendig)</li><li>Mehrsprachenfähig</li></ul><a href=#anleitung><h2 id=anleitung><span class=hanchor arialabel=Anchor># </span>Anleitung</h2></a><a href=#iis-server-vorbereitung><h3 id=iis-server-vorbereitung><span class=hanchor arialabel=Anchor># </span>IIS Server Vorbereitung</h3></a><p>In dieser Anleitung wird auf einer separaten Partition/Festplatte mit dem <strong>Laufwerksbuchstaben U</strong> die komplette Konfiguration der Webseite sowie die Abspeicherung des Kontents erstellt. Dabei sind 500GB ausreichend. Es empfiehlt sich den Kontent des AUSST von der Systempartition zu trennen.</p><a href=#ausst-executable><h4 id=ausst-executable><span class=hanchor arialabel=Anchor># </span>AUSST Executable</h4></a><p>Als erstes muss die namendgebende AUSST Executable heruntergeladen werden. Dazu muss das Adobe Adminportal unter
<a href=https://adminconsole.adobe.com rel=noopener>adminconsole.adobe.com</a> aufgerufen werden.
Sobald sich erfolgreich mit den Unternehmensdaten angemeldet wurde, kann unter <em>Pakete > Tools</em> das &ldquo;Adobe Update Server Setup Tool&rdquo; als Windows Version heruntergeladen werden.
<img src=/notes/images/AUSST.png width=auto>
Dabei beinhaltet die ZIP Datei folgende Dateien.
<img src=/notes/images/AUSST2.png width=auto></p><p>Die ZIP Datei sollte nun unter <em>U:\</em> abgelegt werden, sodass die Executable unter dem Pfad <em>U:\AUSST\AdobeUpdateServerSetupTool.exe</em> erreichbar ist.</p><a href=#skript><h4 id=skript><span class=hanchor arialabel=Anchor># </span>Skript</h4></a><p>Zur IIS Vorbereitung kann folgendes Skript genutzt werden. Das Skript tut im groben:</p><ul><li>Einen IIS Applikation Pool mit eigener Webseite auf dem Port 6443</li><li>Fügt diverse benötigte WebHandler und Fileextensions hinzu</li><li>Eine Ordnerstruktur auf dem U:\ Laufwerk erstellen</li><li>Firewall Regeln für Port 6443 erstellen</li><li>Erstellen eines Scheduled Task in der Aufgabenplanung für die periodische Synchronisierung des Kontents und der Erstellung der Client Konfiguration</li></ul><p>Für die manuelle Durchführung der Schritte empfiehlt sich diese Anleitung:
<a href=https://www.wsus.de/ausst/ rel=noopener>https://www.wsus.de/ausst/</a></p><div class=highlight title=AUSST-IIS-Prep.ps1><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># +----------------------------------------------------------------------------+</span>
</span></span><span class=line><span class=cl><span class=c># | Actions |</span>
</span></span><span class=line><span class=cl><span class=c># +----------------------------------------------------------------------------+</span>
</span></span><span class=line><span class=cl><span class=c># | - Create a new IIS Site &#34;Adobe Update Server&#34; on Port 6443 |</span>
</span></span><span class=line><span class=cl><span class=c># | - Create a new AppPool &#34;AUSSTAppPool&#34; |</span>
</span></span><span class=line><span class=cl><span class=c># | - Configure Firewall |</span>
</span></span><span class=line><span class=cl><span class=c># | - Create Schedule Task for Sync |</span>
</span></span><span class=line><span class=cl><span class=c># +----------------------------------------------------------------------------+</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl><span class=c># Execution Policy check</span>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$Policy</span> <span class=p>=</span> <span class=s2>&#34;Unrestricted&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>If</span> <span class=p>((</span><span class=nb>Get-ExecutionPolicy</span><span class=p>)</span> <span class=o>-ne</span> <span class=nv>$Policy</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nb>Write-Host</span> <span class=s2>&#34;Setting up execution policy&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl>   <span class=nb>Set-ExecutionPolicy</span> <span class=nv>$Policy</span> <span class=n>-Scope</span> <span class=n>CurrentUser</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl>   <span class=nb>Write-Host</span> <span class=s2>&#34;Relaunch this script&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl>   <span class=n>Exit</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl><span class=c># Setup the things we need, Modules, Downloads, variables etc.</span>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Server managed module, used to install IIS.</span>
</span></span><span class=line><span class=cl><span class=nb>Import-Module</span> <span class=n>ServerManager</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Get the current hostname.</span>
</span></span><span class=line><span class=cl><span class=nv>$hostName</span><span class=p>=(</span><span class=nb>Get-WmiObject</span> <span class=n>win32_computersystem</span><span class=p>).</span><span class=n>DNSHostName</span><span class=p>+</span><span class=s2>&#34;.&#34;</span><span class=p>+(</span><span class=nb>Get-WmiObject</span> <span class=n>win32_computersystem</span><span class=p>).</span><span class=n>Domain</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Various Paths.</span>
</span></span><span class=line><span class=cl><span class=nv>$InetPubRoot</span> <span class=p>=</span> <span class=s2>&#34;U:\Inetpub&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$InetPubLog</span> <span class=p>=</span> <span class=s2>&#34;U:\Inetpub\Log&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$InetPubWWWRoot</span> <span class=p>=</span> <span class=s2>&#34;U:\Inetpub\WWWRoot&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$InetPubWWWAdobe</span> <span class=p>=</span> <span class=s2>&#34;U:\Inetpub\WWWRoot\Adobe&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$InetPubWWWAdobeCS</span> <span class=p>=</span> <span class=s2>&#34;U:\Inetpub\WWWRoot\Adobe\CS&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$InetPubWWWAdobeCSConfig</span> <span class=p>=</span> <span class=s2>&#34;U:\Inetpub\WWWRoot\Adobe\CS\config&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$InetPubWWWAdobeConfig</span> <span class=p>=</span> <span class=s2>&#34;U:\Inetpub\WWWRoot\Adobe\CS\config\AdobeUpdaterClient&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$InetPubLog</span> <span class=p>=</span> <span class=s2>&#34;U:\Inetpub\Log&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$IISSiteName</span> <span class=p>=</span> <span class=s2>&#34;Adobe Update Server - 6443&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$IISAppPoolName</span> <span class=p>=</span> <span class=s2>&#34;AUSSTAppPool&#34;</span>
</span></span><span class=line><span class=cl><span class=no>[string]</span><span class=nv>$IISPort</span> <span class=p>=</span> <span class=s2>&#34;6443&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># AUSST tool options, used for the Scheduled Tasks.</span>
</span></span><span class=line><span class=cl><span class=nv>$setup</span><span class=p>=</span><span class=s2>&#34;U:\AUSST\AdobeUpdateServerSetupTool.exe&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$setupoptions</span> <span class=p>=</span> <span class=s2>&#34;--root=$InetPubWWWAdobeCS --fresh --silent&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$updateoptions</span> <span class=p>=</span> <span class=s2>&#34;--root=$InetPubWWWAdobeCS --incremental&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$clientoptions</span> <span class=p>=</span> <span class=s1>&#39;--genclientconf=&#34;&#39;</span> <span class=p>+</span> <span class=nv>$InetPubWWWAdobeConfig</span> <span class=p>+</span> <span class=s1>&#39;&#34; --root=&#34;&#39;</span> <span class=p>+</span> <span class=nv>$InetPubWWWAdobeCS</span> <span class=p>+</span> <span class=s1>&#39;&#34; --url=&#34;http://&#39;</span> <span class=p>+</span> <span class=nv>$hostname</span> <span class=p>+</span> <span class=s1>&#39;:&#39;</span> <span class=p>+</span> <span class=nv>$IISPort</span> <span class=p>+</span><span class=s1>&#39;/Adobe/CS&#34;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Create our IIS folder structure</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>Function</span> <span class=n>createFolder</span><span class=p>(</span><span class=no>[STRING]</span><span class=nv>$Path</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nv>$exists</span> <span class=p>=</span> <span class=nb>Test-Path</span> <span class=nv>$Path</span> <span class=n>-pathType</span> <span class=n>container</span>
</span></span><span class=line><span class=cl>   <span class=k>if</span> <span class=p>(</span><span class=nv>$exists</span> <span class=o>-eq</span> <span class=nv>$false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>{</span>
</span></span><span class=line><span class=cl>   	<span class=nb>Write-Host</span> <span class=s2>&#34;We are going to try and create the folder...&#34;</span> <span class=nv>$Path</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl>   	<span class=k>try</span>
</span></span><span class=line><span class=cl>   	<span class=p>{</span>
</span></span><span class=line><span class=cl>   		<span class=nb>New-Item</span> <span class=n>-Path</span> <span class=nv>$Path</span> <span class=n>-type</span> <span class=n>directory</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl>   	<span class=p>}</span>
</span></span><span class=line><span class=cl>   	<span class=k>Catch</span>
</span></span><span class=line><span class=cl>   	<span class=p>{</span>
</span></span><span class=line><span class=cl>   		<span class=nb>Write-Host</span> <span class=s2>&#34;Folder creation failed&#34;</span> <span class=nv>$Path</span> <span class=n>-backgroundcolor</span> <span class=n>red</span> <span class=n>-foregroundcolor</span> <span class=n>white</span>
</span></span><span class=line><span class=cl>   	<span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=k>else</span>
</span></span><span class=line><span class=cl>   <span class=p>{</span>
</span></span><span class=line><span class=cl>   	<span class=nb>Write-Host</span> <span class=s2>&#34;Just reporting this folder exists...&#34;</span> <span class=nv>$Path</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>createFolder</span> <span class=nv>$InetPubRoot</span>
</span></span><span class=line><span class=cl><span class=n>createFolder</span> <span class=nv>$InetPubLog</span>
</span></span><span class=line><span class=cl><span class=n>createFolder</span> <span class=nv>$InetPubWWWRoot</span>
</span></span><span class=line><span class=cl><span class=n>createFolder</span> <span class=nv>$InetPubWWWAdobe</span>
</span></span><span class=line><span class=cl><span class=n>createFolder</span> <span class=nv>$InetPubWWWAdobeCS</span>
</span></span><span class=line><span class=cl><span class=n>createfolder</span> <span class=nv>$InetPubWWWAdobeCSConfig</span>
</span></span><span class=line><span class=cl><span class=n>createFolder</span> <span class=nv>$InetPubLog</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl><span class=c># Install IIS</span>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Installing IIS&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nb>Add-WindowsFeature</span> <span class=n>-Name</span> <span class=nb>web-server</span><span class=p>,</span> <span class=nb>web-mgmt</span><span class=n>-console</span><span class=p>,</span> <span class=nb>Web-ISAPI</span><span class=n>-Ext</span><span class=p>,</span> <span class=nb>Web-ISAPI</span><span class=n>-Filter</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>catch</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nb>Write-Host</span> <span class=s2>&#34;IIS Install failed.&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>red</span> <span class=n>-foregroundcolor</span> <span class=n>white</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl><span class=c># Setup IIS</span>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Import-Module</span> <span class=n>WebAdministration</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Create App Pool and new Website</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Setup new IIS AppPool&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl><span class=nb>New-WebAppPool</span> <span class=n>-Name</span> <span class=s2>&#34;AUSSTAppPool&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>Start-Sleep</span> <span class=n>-s</span> <span class=n>10</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Setup App Pool Manager Pipeline mode to Classic</span>
</span></span><span class=line><span class=cl><span class=nv>$appPool</span> <span class=p>=</span> <span class=nb>Get-Item</span> <span class=n>IIS</span><span class=err>:</span><span class=p>\</span><span class=n>AppPools</span><span class=p>\</span><span class=n>AUSSTAppPool</span>
</span></span><span class=line><span class=cl><span class=nv>$appPool</span><span class=p>.</span><span class=n>managedPipelineMode</span> <span class=p>=</span> <span class=s2>&#34;Classic&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$appPool</span> <span class=p>|</span> <span class=nb>Set-Item</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Create new IIS Website&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl><span class=nb>New-Website</span> <span class=n>-Name</span> <span class=s2>&#34;$IISSiteName&#34;</span> <span class=n>-PhysicalPath</span> <span class=s2>&#34;$InetPubWWWRoot&#34;</span> <span class=n>-Port</span> <span class=n>6443</span> <span class=n>-ApplicationPool</span> <span class=s2>&#34;AUSSTAppPool&#34;</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Setup Website LogDirPath&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl><span class=nb>Set-ItemProperty</span> <span class=s1>&#39;IIS:\Sites\Adobe Update Server - 6443&#39;</span> <span class=n>-name</span> <span class=n>logfile</span><span class=p>.</span><span class=n>directory</span> <span class=n>-value</span> <span class=nv>$InetPubLog</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Setup Directory Browsing&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl><span class=nb>Set-WebConfigurationProperty</span> <span class=n>-filter</span> <span class=p>/</span><span class=n>system</span><span class=p>.</span><span class=n>webServer</span><span class=p>/</span><span class=n>directoryBrowse</span> <span class=n>-name</span> <span class=n>enabled</span> <span class=n>-PSPath</span> <span class=s1>&#39;IIS:\Sites\Adobe Update Server - 6443&#39;</span> <span class=n>-Value</span> <span class=n>true</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Start-Sleep</span> <span class=n>-s</span> <span class=n>10</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nb>Test-Path</span> <span class=s2>&#34;IIS:\Sites\Adobe Update Server - 6443&#34;</span><span class=p>)</span> <span class=p>{</span><span class=nb>Write-Host</span> <span class=s2>&#34;$IISSiteName Website created.&#34;</span> <span class=n>-foregroundcolor</span> <span class=n>green</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Setup Module Mappings, httpHandlers and MIME types.</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Setup Module Mappings, httpHandlers and MIME types&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl><span class=nv>$unlockCommand</span> <span class=p>=</span> <span class=s2>&#34;$env:WINDIR\system32\inetsrv\appcmd.exe&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$unlockOptions</span> <span class=p>=</span> <span class=s2>&#34;unlock config -section:system.webServer/handlers&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Expression</span> <span class=n>-Command</span> <span class=s2>&#34;$unlockCommand $unlockOptions&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>New-WebHandler</span> <span class=n>-Name</span> <span class=s2>&#34;AdobeXML&#34;</span> <span class=n>-Path</span> <span class=s2>&#34;*.xml&#34;</span> <span class=n>-Verb</span> <span class=s1>&#39;GET,POST&#39;</span> <span class=n>-Modules</span> <span class=n>IsapiModule</span> <span class=n>-ScriptProcessor</span> <span class=s2>&#34;C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll&#34;</span> <span class=n>-PSPath</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-RequiredAccess</span> <span class=n>Read</span> <span class=n>-ResourceType</span> <span class=n>File</span>
</span></span><span class=line><span class=cl><span class=nb>New-WebHandler</span> <span class=n>-Name</span> <span class=s2>&#34;AdobeCRL&#34;</span> <span class=n>-Path</span> <span class=s2>&#34;*.crl&#34;</span> <span class=n>-Verb</span> <span class=s1>&#39;GET,POST&#39;</span> <span class=n>-Modules</span> <span class=n>IsapiModule</span> <span class=n>-ScriptProcessor</span> <span class=s2>&#34;C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll&#34;</span> <span class=n>-PSPath</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-RequiredAccess</span> <span class=n>Read</span> <span class=n>-ResourceType</span> <span class=n>File</span>
</span></span><span class=line><span class=cl><span class=nb>New-WebHandler</span> <span class=n>-Name</span> <span class=s2>&#34;AdobeZIP&#34;</span> <span class=n>-Path</span> <span class=s2>&#34;*.zip&#34;</span> <span class=n>-Verb</span> <span class=s1>&#39;GET,POST&#39;</span> <span class=n>-Modules</span> <span class=n>IsapiModule</span> <span class=n>-ScriptProcessor</span> <span class=s2>&#34;C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll&#34;</span> <span class=n>-PSPath</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-RequiredAccess</span> <span class=n>Read</span> <span class=n>-ResourceType</span> <span class=n>File</span>
</span></span><span class=line><span class=cl><span class=nb>New-WebHandler</span> <span class=n>-Name</span> <span class=s2>&#34;AdobeDMG&#34;</span> <span class=n>-Path</span> <span class=s2>&#34;*.dmg&#34;</span> <span class=n>-Verb</span> <span class=s1>&#39;GET,POST&#39;</span> <span class=n>-Modules</span> <span class=n>IsapiModule</span> <span class=n>-ScriptProcessor</span> <span class=s2>&#34;C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll&#34;</span> <span class=n>-PSPath</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-RequiredAccess</span> <span class=n>Read</span> <span class=n>-ResourceType</span> <span class=n>File</span>
</span></span><span class=line><span class=cl><span class=nb>New-WebHandler</span> <span class=n>-Name</span> <span class=s2>&#34;AdobeSIG&#34;</span> <span class=n>-Path</span> <span class=s2>&#34;*.sig&#34;</span> <span class=n>-Verb</span> <span class=s1>&#39;GET,POST&#39;</span> <span class=n>-Modules</span> <span class=n>IsapiModule</span> <span class=n>-ScriptProcessor</span> <span class=s2>&#34;C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll&#34;</span> <span class=n>-PSPath</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-RequiredAccess</span> <span class=n>Read</span> <span class=n>-ResourceType</span> <span class=n>File</span>
</span></span><span class=line><span class=cl><span class=nb>New-WebHandler</span> <span class=n>-Name</span> <span class=s2>&#34;AdobeARM&#34;</span> <span class=n>-Path</span> <span class=s2>&#34;*.arm&#34;</span> <span class=n>-Verb</span> <span class=s1>&#39;GET,POST&#39;</span> <span class=n>-Modules</span> <span class=n>IsapiModule</span> <span class=n>-ScriptProcessor</span> <span class=s2>&#34;C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll&#34;</span> <span class=n>-PSPath</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-RequiredAccess</span> <span class=n>Read</span> <span class=n>-ResourceType</span> <span class=n>File</span>
</span></span><span class=line><span class=cl><span class=nb>New-WebHandler</span> <span class=n>-Name</span> <span class=s2>&#34;AdobeJSON&#34;</span> <span class=n>-Path</span> <span class=s2>&#34;*.json&#34;</span> <span class=n>-Verb</span> <span class=s1>&#39;GET,POST&#39;</span> <span class=n>-Modules</span> <span class=n>IsapiModule</span> <span class=n>-ScriptProcessor</span> <span class=s2>&#34;C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll&#34;</span> <span class=n>-PSPath</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-RequiredAccess</span> <span class=n>Read</span> <span class=n>-ResourceType</span> <span class=n>File</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Add-WebConfiguration</span> <span class=p>/</span><span class=n>system</span><span class=p>.</span><span class=n>web</span><span class=p>/</span><span class=n>httpHandlers</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-AtIndex</span> <span class=n>3</span> <span class=n>-Value</span> <span class=p>@{</span><span class=n>path</span><span class=p>=</span><span class=s2>&#34;*.xml&#34;</span><span class=p>;</span><span class=n>verb</span><span class=p>=</span><span class=s2>&#34;*&#34;</span><span class=p>;</span><span class=n>type</span><span class=p>=</span><span class=s2>&#34;System.Web.StaticFileHandler&#34;</span><span class=p>;</span><span class=n>validate</span><span class=p>=</span><span class=s2>&#34;true&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Add-WebConfiguration</span> <span class=p>/</span><span class=n>system</span><span class=p>.</span><span class=n>web</span><span class=p>/</span><span class=n>httpHandlers</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-AtIndex</span> <span class=n>4</span> <span class=n>-Value</span> <span class=p>@{</span><span class=n>path</span><span class=p>=</span><span class=s2>&#34;*.zip&#34;</span><span class=p>;</span><span class=n>verb</span><span class=p>=</span><span class=s2>&#34;*&#34;</span><span class=p>;</span><span class=n>type</span><span class=p>=</span><span class=s2>&#34;System.Web.StaticFileHandler&#34;</span><span class=p>;</span><span class=n>validate</span><span class=p>=</span><span class=s2>&#34;true&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Add-WebConfiguration</span> <span class=p>/</span><span class=n>system</span><span class=p>.</span><span class=n>web</span><span class=p>/</span><span class=n>httpHandlers</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-AtIndex</span> <span class=n>5</span> <span class=n>-Value</span> <span class=p>@{</span><span class=n>path</span><span class=p>=</span><span class=s2>&#34;*.dmg&#34;</span><span class=p>;</span><span class=n>verb</span><span class=p>=</span><span class=s2>&#34;*&#34;</span><span class=p>;</span><span class=n>type</span><span class=p>=</span><span class=s2>&#34;System.Web.StaticFileHandler&#34;</span><span class=p>;</span><span class=n>validate</span><span class=p>=</span><span class=s2>&#34;true&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Add-WebConfiguration</span> <span class=p>/</span><span class=n>system</span><span class=p>.</span><span class=n>web</span><span class=p>/</span><span class=n>httpHandlers</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-AtIndex</span> <span class=n>6</span> <span class=n>-Value</span> <span class=p>@{</span><span class=n>path</span><span class=p>=</span><span class=s2>&#34;*.sig&#34;</span><span class=p>;</span><span class=n>verb</span><span class=p>=</span><span class=s2>&#34;*&#34;</span><span class=p>;</span><span class=n>type</span><span class=p>=</span><span class=s2>&#34;System.Web.StaticFileHandler&#34;</span><span class=p>;</span><span class=n>validate</span><span class=p>=</span><span class=s2>&#34;true&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Add-WebConfiguration</span> <span class=p>/</span><span class=n>system</span><span class=p>.</span><span class=n>web</span><span class=p>/</span><span class=n>httpHandlers</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-AtIndex</span> <span class=n>7</span> <span class=n>-Value</span> <span class=p>@{</span><span class=n>path</span><span class=p>=</span><span class=s2>&#34;*.crl&#34;</span><span class=p>;</span><span class=n>verb</span><span class=p>=</span><span class=s2>&#34;*&#34;</span><span class=p>;</span><span class=n>type</span><span class=p>=</span><span class=s2>&#34;System.Web.StaticFileHandler&#34;</span><span class=p>;</span><span class=n>validate</span><span class=p>=</span><span class=s2>&#34;true&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Add-WebConfiguration</span> <span class=p>/</span><span class=n>system</span><span class=p>.</span><span class=n>web</span><span class=p>/</span><span class=n>httpHandlers</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-AtIndex</span> <span class=n>8</span> <span class=n>-Value</span> <span class=p>@{</span><span class=n>path</span><span class=p>=</span><span class=s2>&#34;*.json&#34;</span><span class=p>;</span><span class=n>verb</span><span class=p>=</span><span class=s2>&#34;*&#34;</span><span class=p>;</span><span class=n>type</span><span class=p>=</span><span class=s2>&#34;System.Web.StaticFileHandler&#34;</span><span class=p>;</span><span class=n>validate</span><span class=p>=</span><span class=s2>&#34;true&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Add-WebConfiguration</span> <span class=p>/</span><span class=n>system</span><span class=p>.</span><span class=n>web</span><span class=p>/</span><span class=n>httpHandlers</span> <span class=s2>&#34;IIS:\sites\Adobe Update Server - 6443&#34;</span> <span class=n>-AtIndex</span> <span class=n>9</span> <span class=n>-Value</span> <span class=p>@{</span><span class=n>path</span><span class=p>=</span><span class=s2>&#34;*.arm&#34;</span><span class=p>;</span><span class=n>verb</span><span class=p>=</span><span class=s2>&#34;*&#34;</span><span class=p>;</span><span class=n>type</span><span class=p>=</span><span class=s2>&#34;System.Web.StaticFileHandler&#34;</span><span class=p>;</span><span class=n>validate</span><span class=p>=</span><span class=s2>&#34;true&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#Allow unspecified ISAPI modules</span>
</span></span><span class=line><span class=cl><span class=nb>set-webconfiguration</span> <span class=n>system</span><span class=p>.</span><span class=n>webserver</span><span class=p>/</span><span class=n>security</span><span class=p>/</span><span class=n>isapiCGIRestriction</span> <span class=n>-value</span> <span class=s2>&#34;True&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#Add MIME-Types</span>
</span></span><span class=line><span class=cl><span class=nb>Add-Webconfigurationproperty</span> <span class=p>//</span><span class=n>staticContent</span> <span class=n>-name</span> <span class=n>collection</span> <span class=n>-value</span> <span class=p>@{</span><span class=n>fileExtension</span><span class=p>=</span><span class=s1>&#39;.pkg&#39;</span><span class=p>;</span> <span class=n>mimeType</span><span class=p>=</span><span class=s1>&#39;application/octet-stream&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Add-Webconfigurationproperty</span> <span class=p>//</span><span class=n>staticContent</span> <span class=n>-name</span> <span class=n>collection</span> <span class=n>-value</span> <span class=p>@{</span><span class=n>fileExtension</span><span class=p>=</span><span class=s1>&#39;.msp&#39;</span><span class=p>;</span> <span class=n>mimeType</span><span class=p>=</span><span class=s1>&#39;application/octet-stream&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Add-Webconfigurationproperty</span> <span class=p>//</span><span class=n>staticContent</span> <span class=n>-name</span> <span class=n>collection</span> <span class=n>-value</span> <span class=p>@{</span><span class=n>fileExtension</span><span class=p>=</span><span class=s1>&#39;.arm&#39;</span><span class=p>;</span> <span class=n>mimeType</span><span class=p>=</span><span class=s1>&#39;application/octet-stream&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Add-Webconfigurationproperty</span> <span class=p>//</span><span class=n>staticContent</span> <span class=n>-name</span> <span class=n>collection</span> <span class=n>-value</span> <span class=p>@{</span><span class=n>fileExtension</span><span class=p>=</span><span class=s1>&#39;.sig&#39;</span><span class=p>;</span> <span class=n>mimeType</span><span class=p>=</span><span class=s1>&#39;application/octet-stream&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Add-Webconfigurationproperty</span> <span class=p>//</span><span class=n>staticContent</span> <span class=n>-name</span> <span class=n>collection</span> <span class=n>-value</span> <span class=p>@{</span><span class=n>fileExtension</span><span class=p>=</span><span class=s1>&#39;.dmg&#39;</span><span class=p>;</span> <span class=n>mimeType</span><span class=p>=</span><span class=s1>&#39;file/download&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Copy web.config</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Copy web.config file&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl><span class=nv>$f1</span> <span class=p>=</span> <span class=s2>&#34;$InetPubWWWRoot&#34;</span> <span class=p>+</span> <span class=s2>&#34;\web.config&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$f2</span> <span class=p>=</span> <span class=s2>&#34;$InetPubWWWAdobeCS&#34;</span> <span class=p>+</span> <span class=s2>&#34;\ACC\services\ffc\icons&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$f3</span> <span class=p>=</span> <span class=s2>&#34;$InetPubWWWAdobeCS&#34;</span> <span class=p>+</span> <span class=s2>&#34;\ACC\services\ffc\validation&#34;</span>
</span></span><span class=line><span class=cl><span class=n>createFolder</span> <span class=nv>$f2</span>
</span></span><span class=line><span class=cl><span class=n>createFolder</span> <span class=nv>$f3</span>
</span></span><span class=line><span class=cl><span class=nb>Copy-Item</span> <span class=nv>$f1</span> <span class=nv>$f2</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl><span class=nb>Copy-Item</span> <span class=nv>$f1</span> <span class=nv>$f3</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl><span class=c># Configure Firewall</span>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Setup Firewall&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl><span class=nb>New-NetFirewallRule</span> <span class=n>-DisplayName</span> <span class=s2>&#34;Allow AUSST Client Connections - Inbound&#34;</span> <span class=n>-Direction</span> <span class=n>Inbound</span> <span class=n>-Action</span> <span class=n>Allow</span> <span class=n>-Protocol</span> <span class=n>TCP</span> <span class=n>-LocalPort</span> <span class=n>6443</span>
</span></span><span class=line><span class=cl><span class=nb>New-NetFirewallRule</span> <span class=n>-DisplayName</span> <span class=s2>&#34;Allow AUSST Client Connections - Outbound&#34;</span> <span class=n>-Direction</span> <span class=n>Outbound</span> <span class=n>-Action</span> <span class=n>Allow</span> <span class=n>-Protocol</span> <span class=n>TCP</span> <span class=n>-LocalPort</span> <span class=n>6443</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl><span class=c># Create the setup tasks and sync tasks.</span>
</span></span><span class=line><span class=cl><span class=c># ----</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Create Schedule Tasks&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Setup the initial setup task to run in 10 minutes, we can re run this task at a later date as a last resort if we have issues as it will re sync the updates.</span>
</span></span><span class=line><span class=cl><span class=c>#$Action = New-ScheduledTaskAction -execute $setup -argument $setupoptions</span>
</span></span><span class=line><span class=cl><span class=c>#$Trigger = theNew-ScheduledTaskTrigger -Once -At ((get-date) + (New-TimeSpan -Minutes 10))</span>
</span></span><span class=line><span class=cl><span class=c>#Register-ScheduledTask -TaskName AUSST_Setup Adobe -Trigger $Trigger -Action $Action -description &#34;AUSST Setup&#34; -User &#34;NT AUTHORITY\SYSTEM&#34; -RunLevel 1</span>
</span></span><span class=line><span class=cl><span class=c>#Set-ScheduledTask AUSST_Setup Adobe -Trigger $Trigger</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Setup the ongoing sync task.</span>
</span></span><span class=line><span class=cl><span class=nv>$Action</span> <span class=p>=</span> <span class=nb>New-ScheduledTaskAction</span> <span class=n>-execute</span> <span class=nv>$setup</span> <span class=n>-argument</span> <span class=nv>$updateoptions</span>
</span></span><span class=line><span class=cl><span class=nv>$Trigger</span> <span class=p>=</span> <span class=nb>New-ScheduledTaskTrigger</span> <span class=n>-Once</span> <span class=n>-At</span> <span class=n>23</span><span class=err>:</span><span class=n>59PM</span>
</span></span><span class=line><span class=cl><span class=nb>Register-ScheduledTask</span> <span class=n>-TaskName</span> <span class=n>AUSST_Update</span> <span class=n>Adobe</span> <span class=n>-Trigger</span> <span class=nv>$Trigger</span> <span class=n>-Action</span> <span class=nv>$Action</span> <span class=n>-description</span> <span class=s2>&#34;AUSST Update&#34;</span> <span class=n>-User</span> <span class=s2>&#34;NT AUTHORITY\SYSTEM&#34;</span> <span class=n>-RunLevel</span> <span class=n>1</span>
</span></span><span class=line><span class=cl><span class=nv>$Trigger</span><span class=p>.</span><span class=n>RepetitionInterval</span> <span class=p>=</span> <span class=p>(</span><span class=nb>New-TimeSpan</span> <span class=n>-Days</span> <span class=n>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$Trigger</span><span class=p>.</span><span class=n>RepetitionDuration</span> <span class=p>=</span> <span class=p>(</span><span class=nb>New-TimeSpan</span> <span class=n>-Days</span> <span class=n>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>Set-ScheduledTask</span> <span class=n>AUSST_Update</span> <span class=n>Adobe</span> <span class=n>-Trigger</span> <span class=nv>$Trigger</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Setup Client Config Generation, this has to be ran once the server has downloaded the updates, recommend 24Hours.</span>
</span></span><span class=line><span class=cl><span class=nv>$Action</span> <span class=p>=</span> <span class=nb>New-ScheduledTaskAction</span> <span class=n>-execute</span> <span class=nv>$setup</span> <span class=n>-argument</span> <span class=nv>$clientoptions</span>
</span></span><span class=line><span class=cl><span class=nv>$Trigger</span> <span class=p>=</span> <span class=nb>New-ScheduledTaskTrigger</span> <span class=n>-Once</span> <span class=n>-At</span> <span class=p>((</span><span class=nb>get-date</span><span class=p>)</span> <span class=p>+</span> <span class=p>(</span><span class=nb>New-TimeSpan</span> <span class=n>-Days</span> <span class=n>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>Register-ScheduledTask</span> <span class=n>-TaskName</span> <span class=n>AUSST_Client</span> <span class=n>Adobe</span> <span class=n>-Trigger</span> <span class=nv>$Trigger</span> <span class=n>-Action</span> <span class=nv>$Action</span> <span class=n>-description</span> <span class=s2>&#34;AUSST Client Config&#34;</span> <span class=n>-User</span> <span class=s2>&#34;NT AUTHORITY\SYSTEM&#34;</span> <span class=n>-RunLevel</span> <span class=n>1</span>
</span></span><span class=line><span class=cl><span class=n>-ScheduledTask</span> <span class=n>AUSST_client</span> <span class=n>Adobe</span> <span class=n>-Trigger</span> <span class=nv>$Trigger</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># FINISH.</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Adobe Update Server - created&#34;</span> <span class=n>-backgroundcolor</span> <span class=n>black</span> <span class=n>-foregroundcolor</span> <span class=n>green</span>
</span></span></code></pre></td></tr></table></div></div><a href=#ausst-synchronisation><h3 id=ausst-synchronisation><span class=hanchor arialabel=Anchor># </span>AUSST Synchronisation</h3></a><p>Die zuvor heruntergeladene Executable wird genutzt um sowohl die Client Konfiguration zu erstellen als auch den benötigten Kontent herunterzuladen.
Die folgenden Befehle können ebenfalls über einen Scheduled Task in der Aufgabenplanung ausgeführt werden oder in einer Batch Datei verpackt werden um diese auszuführen. Die unten aufgeführten Tasks <strong>werden automatisch vom Skript erstellt</strong> und können nach belieben angepasst werden.
<img src=/notes/images/AUSST3.png width=auto></p><a href=#inkrementelle-synchronisation><h4 id=inkrementelle-synchronisation><span class=hanchor arialabel=Anchor># </span>Inkrementelle Synchronisation</h4></a><p>Bei einer inkrementelle Synchronisation, wird nur neuer Kontent synchronisiert.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>U:<span class=se>\A</span>USST<span class=se>\A</span>dobeUpdateServerSetupTool.exe --root<span class=o>=</span><span class=s2>&#34;/serverroot/updates/Adobe/&#34;</span> --incremental <span class=o>[</span>--proxyusername<span class=o>=</span>proxy_username --proxypassword<span class=o>=</span>proxy_password<span class=o>]</span> <span class=o>[</span>--acrobatonly<span class=o>]</span> <span class=o>[</span>--filterProducts<span class=o>=</span>&lt;Product filter options&gt;<span class=o>]</span> <span class=o>[</span>--filterFilePath<span class=o>=</span>&lt;Product filter filepath&gt;<span class=o>]</span> <span class=o>[</span>--legacyUpdates<span class=o>]</span> <span class=o>[</span>--cleanup<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>Ebenfalls kann auch mit dem Befehl <code>--filterProducts=ESHR#3.0</code> nur bestimmte Produkte und durch den Zusatz einer Version (bspw. <code>#3.0</code>) nur bestimmte Versionen heruntergeladen werden. Dies ist besonders hilfreich um Speicherplatz zu sparen, wenn nur vereinzelt Produkte in der Umgebung genutzt werden.
Die dazu nutzbare Abkürzungen für die Anwendungen ist unter
<a href=https://helpx.adobe.com/de/enterprise/kb/apps-deployed-without-base-versions.html rel=noopener>dieser Webseite</a> zu finden.</p><a href=#fresh-synchronisation><h4 id=fresh-synchronisation><span class=hanchor arialabel=Anchor># </span>Fresh Synchronisation</h4></a><p>Die Fresh Synchronisation, synchronisiert einmal den kompletten Kontent neu.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>U:<span class=se>\A</span>USST<span class=se>\A</span>dobeUpdateServerSetupTool.exe --root<span class=o>=</span><span class=s2>&#34;/serverroot/updates/Adobe/&#34;</span> --fresh <span class=o>[</span>--proxyusername<span class=o>=</span>proxy_username --proxypassword<span class=o>=</span>proxy_password<span class=o>]</span> <span class=o>[</span>--silent<span class=o>]</span> <span class=o>[</span>--acrobatonly<span class=o>]</span> <span class=o>[</span>--filterProducts<span class=o>=</span>&lt;Product filter options&gt;<span class=o>]</span> <span class=o>[</span>--filterFilePath<span class=o>=</span>&lt;Product filter filepath&gt;<span class=o>]</span> <span class=o>[</span>--legacyUpdates<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><a href=#client-konfiguration><h3 id=client-konfiguration><span class=hanchor arialabel=Anchor># </span>Client Konfiguration</h3></a><p>Die Konfigurationsdatei wird dazu genutzt um dem Programm zu zeigen, wo er nach Updates und Installationsdateien suchen muss.</p><a href=#konfiguration-erstellen><h4 id=konfiguration-erstellen><span class=hanchor arialabel=Anchor># </span>Konfiguration erstellen</h4></a><p>Um die Konfiguration zu erstellen wird ebenfalls die AUSST Executable genutzt. Unten stehender Befehl kanns als Beispiel genutzt werden.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>U:<span class=se>\A</span>USST<span class=se>\A</span>dobeUpdateServerSetupTool.exe –root<span class=o>=</span>“U:<span class=se>\I</span>netpub<span class=se>\w</span>wwroot<span class=se>\A</span>dobe<span class=se>\C</span>S“ –genclientconf<span class=o>=</span>“C:<span class=se>\i</span>netpub<span class=se>\w</span>wwroot<span class=se>\A</span>dobe<span class=se>\C</span>S<span class=se>\c</span>onfig<span class=se>\A</span>dobeUpdaterClient<span class=se>\“</span> –url<span class=o>=</span>http://abobeupdate.domain.com:80/Adobe/CS
</span></span></code></pre></td></tr></table></div></div><a href=#konfiguration-verteilen><h4 id=konfiguration-verteilen><span class=hanchor arialabel=Anchor># </span>Konfiguration verteilen</h4></a><p>Damit die Anwendungen wissen, dass sie nicht die Update von einem externen Server aus dem Internet holen sollen, müssen die erstellten Konfigurationsdateien (AdobeUpdater.Override) in die folgende Verzeichnisse kopiert werden:</p><a href=#windows-10><h5 id=windows-10><span class=hanchor arialabel=Anchor># </span>Windows 10</h5></a><ul><li>%SYSTEMDRIVE%\ProgramData\Adobe\AAMUpdater\1.0\</li><li>%SYSTEMDRIVE%\Programme (x86)\Common Files\Adobe\UpdaterResources</li></ul><a href=#macos><h5 id=macos><span class=hanchor arialabel=Anchor># </span>macOS</h5></a><ul><li>/Library/Application Support/Adobe/AAMUpdater/1.0/AdobeUpdater.Overrides</li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/notes/Anleitungen/Anleitungen/ data-ctx="notes/Anleitungen/Adobe Update Setup Server Tool (AUSST)" data-src=/notes/Anleitungen/Anleitungen class=internal-link>MOC Anleitungen</a></li></ul></div><div><script async src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interaktiver Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://wiki.timogremler.de/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Timo Gremler using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://wiki.timogremler.de/>Home</a></li><li><a href=https://linkedin.com/in/timo-gremler-7b38b0241>LinkedIn</a></li><li><a href=https://github.com/gremi-jr>GitHub</a></li><li><a href=mailto:wiki@web.gremi.xyz>Kontakt</a></li></ul></footer></div></div></main></body><script src=https://wiki.timogremler.de/js/menu.js></script></html>